define("local_lumination/outline_editor",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/**
   * AMD module for the outline editor in the course review step.
   *
   * Provides interactive add/remove of modules and lessons in the generated
   * course outline before final course creation.
   *
   * @module     local_lumination/outline_editor
   * @copyright  2026 Lumination AI <https://lumination.ai>
   * @license    https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const escapeHtml=s=>{const d=document.createElement("div");return d.textContent=s,d.innerHTML};_exports.init=params=>{const STRINGS=params.strings,container=document.getElementById("lumination-outline-editor"),hiddenField=document.querySelector("input[name=outline_json]");if(!container||!hiddenField)return;let modules;try{modules=JSON.parse(hiddenField.value)}catch(e){modules=[]}const render=()=>{container.innerHTML="",modules.forEach(((mod,mi)=>{const card=document.createElement("div");card.className="lumination-module card mb-3",card.innerHTML='<div class="card-header d-flex justify-content-between align-items-center"><span class="font-weight-bold">'+STRINGS.module+" "+(mi+1)+'</span><button type="button" class="btn btn-sm btn-outline-danger lum-remove-module" data-index="'+mi+'">'+STRINGS.removemodule+'</button></div><div class="card-body"></div>';const body=card.querySelector(".card-body"),titleGroup=document.createElement("div");titleGroup.className="form-group mb-3",titleGroup.innerHTML='<label class="font-weight-bold">'+STRINGS.module+' title</label><input type="text" class="form-control lum-module-title" data-module="'+mi+'" value="'+escapeHtml(mod.title||"")+'">',body.appendChild(titleGroup),(mod.lessons||[]).forEach(((lesson,li)=>{const row=document.createElement("div");row.className="input-group mb-2 lum-lesson-row",row.innerHTML='<div class="input-group-prepend"><span class="input-group-text">'+STRINGS.lesson+" "+(li+1)+'</span></div><input type="text" class="form-control lum-lesson-title" data-module="'+mi+'" data-lesson="'+li+'" value="'+escapeHtml(lesson.title||"")+'"><div class="input-group-append"><button type="button" class="btn btn-outline-danger btn-sm lum-remove-lesson" data-module="'+mi+'" data-lesson="'+li+'">&times;</button></div>',body.appendChild(row)}));const addLessonBtn=document.createElement("button");addLessonBtn.type="button",addLessonBtn.className="btn btn-sm btn-outline-secondary mt-1 lum-add-lesson",addLessonBtn.textContent="+ "+STRINGS.addlesson,addLessonBtn.setAttribute("data-module",mi),body.appendChild(addLessonBtn),container.appendChild(card)}));const addModBtn=document.createElement("button");addModBtn.type="button",addModBtn.className="btn btn-outline-primary mb-3 lum-add-module",addModBtn.textContent="+ "+STRINGS.addmodule,container.appendChild(addModBtn)},sync=()=>{container.querySelectorAll(".lumination-module").forEach(((card,mi)=>{if(!modules[mi])return;const titleInput=card.querySelector(".lum-module-title");titleInput&&(modules[mi].title=titleInput.value);card.querySelectorAll(".lum-lesson-title").forEach(((inp,li)=>{modules[mi].lessons&&modules[mi].lessons[li]&&(modules[mi].lessons[li].title=inp.value)}))})),hiddenField.value=JSON.stringify(modules)};container.addEventListener("click",(e=>{const btn=e.target.closest("button");if(btn){if(sync(),btn.classList.contains("lum-add-module"))modules.push({title:"",lessons:[{title:""}]}),render();else if(btn.classList.contains("lum-remove-module")){if(modules.length<=1)return;modules.splice(parseInt(btn.dataset.index),1),render()}else if(btn.classList.contains("lum-add-lesson")){const mi=parseInt(btn.dataset.module);modules[mi].lessons.push({title:""}),render()}else if(btn.classList.contains("lum-remove-lesson")){const mi=parseInt(btn.dataset.module),li=parseInt(btn.dataset.lesson);if(modules[mi].lessons.length<=1)return;modules[mi].lessons.splice(li,1),render()}sync()}})),container.addEventListener("input",(()=>{sync()}));const form=container.closest("form");form&&form.addEventListener("submit",(()=>{sync();const overlay=document.createElement("div");overlay.id="lumination-loading-overlay",overlay.style.cssText="position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:9999;display:flex;align-items:center;justify-content:center;",overlay.innerHTML='<div style="background:#fff;border-radius:8px;padding:2rem 3rem;text-align:center;max-width:420px;"><div class="spinner-border text-primary mb-3" role="status"><span class="sr-only">Loading...</span></div><h4>'+escapeHtml(STRINGS.generatingcourse)+'</h4><p class="text-muted mb-0">'+escapeHtml(STRINGS.generatingcourse_desc)+"</p></div>",document.body.appendChild(overlay)})),render(),sync()}}));

//# sourceMappingURL=outline_editor.min.js.map